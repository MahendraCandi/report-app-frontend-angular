<div class="text-center">
  <h2 class="display-4">FALLBACK REPORT</h2>
  <p class="blockquote">Generate Excel</p>
</div>
<div class="align-left my-1">
  <form (ngSubmit)="onSubmit()" #fallbackReportForm="ngForm">
      <div class="custom-file mb-3">
          <input type="file" class="custom-file-input" id="customFile" [(ngModel)]="fallbackReport.inputFile"
              name="inputFile" (change)="handleFile($event.target.files)" accept=".json" required #test="ngModel" #spyy>
          <label class="custom-file-label" [ngClass]="{'ng-invalid': test.invalid, 'ng-valid': test.valid}" for="customFile"
              #spy>{{fileName}}</label>
      </div>
      <div class="input-group mb-3">
          <input type="text" class="form-control" placeholder="Output File Name"
              [(ngModel)]="fallbackReport.outputFileName" name="outputFileName" required>
          <div class="input-group-append">
              <span class="input-group-text" id="outputFileName">.xlsx</span>
          </div>
      </div>
      <div class="input-group mb-3">
          <input type="text" class="form-control" placeholder="Title name here" [(ngModel)]="fallbackReport.titleName"
              name="titleName" required>
          <div class="input-group-append">
              <span class="input-group-text" id="titleName">Title Name</span>
          </div>
      </div>
      <div class="input-group mb-3">
          <input type="text" class="form-control" placeholder="Sheet name here" [(ngModel)]="fallbackReport.sheetName"
              name="sheetName" required>
          <div class="input-group-append">
              <span class="input-group-text" id="sheetName">Sheet Name</span>
          </div>
      </div>
      <div class="d-flex">
          <div>
                  <button type="submit" class="btn btn-success">Submit</button>
          </div>
          
          <div *ngIf="loading" class="spinner-border text-info my-auto ml-3 " role="status">
              <span class="sr-only">Loading...</span>
          </div>
          <p *ngIf="loading" class="text-info my-auto ml-1">Please wait...</p>
          <p *ngIf="!isFormValid" class="text-danger my-auto ml-1">{{formMessage}}</p>
          <p *ngIf="isSuccessGenerateReport" class="text-success my-auto ml-1">Success generate report</p>
      </div>
  </form>
</div>